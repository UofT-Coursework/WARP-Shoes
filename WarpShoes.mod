## MIE262 Project
## WARP Shoes
##
## AMPL model file (.mod)
## December 2, 2025

### Sets ###
set SHOE;                                   # i   ; Shoe types, SH001 -- SH557
set MATERIAL;                               # j   ; Raw material, #1 -- #165
set MACHINE;                                # k   ; Machines, #1 -- #72
set WAREHOUSE;                              # l   ; Warehouses, #1 -- #8

### Parameters ###
param sale_price{SHOE};                     # pi  ; Sale price of shoe i ($/pair of shoes)
param shoe_demand{SHOE};                    # di  ; Projected demand of shoe i (pair of shoes)
param material_quantity{SHOE,MATERIAL} default 0; # qij ; Quantity of material j for shoe i (material unit/pair of shoes)
param material_cost{MATERIAL};              # cj  ; Cost of using material j ($/material unit)
param machine_cost{MACHINE};                # mk  ; Operating cost for machine k ($/min)
param operation_time{SHOE,MACHINE} default 0; # tik ; Operation time for machine k on shoe i (sec/pair of shoes)
param warehouse_cost{WAREHOUSE};            # zl  ; Operation cost for warehouse l ($/warehouse)

### Constraint parameters ###
param material_stock{MATERIAL};             # sj  ; Stock of raw material j (material unit)
param warehouse_capacity{WAREHOUSE};        # wl  ; Capacity of warehouse l (pair of shoes)

### Decision variables ###
#var shoes_produced{SHOE} integer >= 0;      # xi ; Quantity of shoe i to produce
var warehouse_used{WAREHOUSE} binary;       # yl ; 1 if warehouse l is used, 0 otherwise 

### Relaxed decision variables ###
# (uncomment and comment corresponding constrained decision variable to use)
var shoes_produced{SHOE} >= 0;              # Relax shoe to allow for fractional production
#var warehouse_used{WAREHOUSE} >= 0, <= 1    # Relax warehouse to allow for fractional use

### Objective function ###
# Function of profit = revenue - costs
# => want to maximize profit
maximize Profit:                            # Profit =
    sum {i in SHOE}                         #   revenue from shoes
        sale_price[i]                       #   ...
      * shoes_produced[i]                   #   ...
  - sum {i in SHOE, j in MATERIAL}          # - cost from raw material used
        material_quantity[i,j]              #   ...
      * material_cost[j]                    #   ...
      * shoes_produced[i]                   #   ...
  - sum {i in SHOE, k in MACHINE}           # - cost from operating machines
        (1/60)                              #   <conversion from seconds to minutes>
      * machine_cost[k]                     #   ...
      * operation_time[i,k]                 #   ...
      * shoes_produced[i]                   #   ...
  - sum {i in SHOE, k in MACHINE}           # - cost from operator wages
        (1/144)                             #   <$25/1hr * 1hr/3600s = 25/3600 = 1/144>
      * machine_cost[k]                     #   ...
      * operation_time[i,k]                 #   ...
      * shoes_produced[i]                   #   ...
  - sum {l in WAREHOUSE}                    # - cost from operating warehouses
        warehouse_cost[l]                   #   ...
      * warehouse_used[l]                   #   ...
  - sum {i in SHOE}                         # - cost from missing demand penalty
        10                                  #   <$10 penalty for missed demand>
      * max(0, shoe_demand[i] - shoes_produced[i]); # <do not apply penalty if demand is met>
  - 10 * 

### Constraints ###
subject to MaterialBudget:                  # Material budget  
    sum {i in SHOE, j in MATERIAL}          # ...
        material_quantity[i,j]              # ...
      * material_cost[j]                    # ...
      * shoes_produced[i]                   # ...
    <= 10000000;                            # <material costs <= $10000000>

subject to MaterialAvailability {j in MATERIAL}: # Material availability (across all 165 materials) 
    sum {i in SHOE}                         # ...
        material_quantity[i,j]              # ...
      * shoes_produced[i]                   # ...
    <= material_stock[j];                   # ...

subject to MachineOperationTimeLimit {k in MACHINE}: # Machine operation time limit over the month (across all 72 machines)
    sum {i in SHOE}                         # ...
        operation_time[i,k]                 # ...
      * shoes_produced[i]                   # ...
    <= 1209600;                             # <60 sec/1 min * 60 min/1 hr * 12 hr/1 day * 28 days = 1209600 sec>

subject to WarehouseCapacity:               # Warehouse capacity (total across all 8 warehouses)
    sum {i in SHOE}                         # Rewrite inequality to have all terms on LHS and 0 on RHS
        shoes_produced[i]                   # ...
  - sum {l in WAREHOUSE}                    # ...
        warehouse_capacity[l]               # ...
      * warehouse_used[l]                   # ...
    <= 0;                                   # ...